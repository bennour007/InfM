facet_grid(Model~., scales = "free") +
labs(
text = "Posterior weights of each words in each topic"
)
data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder_within(term, beta, topic),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
text = "Posterior weights of each words in each topic"
)
plot_weights <- data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder_within(term, beta, topic),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
text = "Posterior weights of each words in each topic"
)
plot_weights %>%
write_rds(here::here("results", "plot_weights.rds"))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse)
tab2 <- read_csv(here::here("results", "top3_topics.csv"))
tab2 %>%
gt::gt(groupname_col = "Model")
tab1 <- read_csv(here::here("results", "top_perplexity.csv"))
tab1 %>%
gt::gt() %>%
gt::tab_header(
title = "Table 1: Models' perpelexity (best 10 models)"
)
tab2 <- read_csv(here::here("results", "top3_topics.csv"))
tab2 %>%
gt::gt(groupname_col = "Model") %>%
gt::tab_header(
title = "Table 2: Best 3 models (topics and terms)"
)
plot_weights <- data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder_within(term, beta, topic),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
text = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder_within(term, beta, topic),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder(term, beta, topic),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights <- data_for_plot %>%
group_by(topic) %>%
# slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder(term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder(term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(Model~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
data_for_plot %>%
filter(Model == "alpha_2_iter_1000")
weights_data_top3 <- lda_results [c("alpha_2_iter_1000", "alpha_0.5_iter_2000", "alpha_0.1_iter_2000")] %>%
map(
function(x){
tidy(x, matrix = "beta") %>%
mutate(across(term, ~ gsub("[\",\\\\]", "", .))) %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta)
}
)
data_for_plot <- map2(
name_w,
weights_data_top3,
function(x,y) {
y %>%
as_tibble() %>%
mutate(
Model = x
)
}
) %>%
bind_rows()
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder(term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
# facet_grid(Model~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder(term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup()
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = reorder_within(within = topic, term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = fct_reorder(term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = as_factor(term),
term = reorder_within(within = topic, term, beta),
term = str_remove_all(term, "___\\d+")
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
term = str_remove_all(term, "___\\d+"),
term = as_factor(term),
term = reorder_within(within = topic, term, beta)
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights <- data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>%
mutate(
# term = str_remove_all(term, "___\\d+"),
term = as_factor(term),
term = reorder_within(within = topic, term, beta)
) %>%
ggplot(
aes(
beta,
term,
fill = factor(topic)
)
) +
geom_col() +
geom_text(
aes(label = round(beta, 4))
) +
facet_grid(topic~., scales = "free") +
labs(
title = "Posterior weights of each words in each topic"
)
plot_weights
plot_weights %>%
write_rds(here::here("results", "plot_weights.rds"))
plot1 <- read_rds(here::here("results", "plot_weights.rds"))
wordc
tab2 <- read_csv(here::here("results", "top3_topics.csv"))
tab2 %>%
gt::gt(groupname_col = "Model") %>%
gt::tab_header(
title = "Table 2: Best 3 models (topics and terms)"
)
tab2 <- read_csv(here::here("results", "top3_topics.csv"))
tab2 %>%
gt::gt(groupname_col = "Model", rowname_col = "term") %>%
gt::tab_header(
title = "Table 2: Best 3 models (topics and terms)"
)
tab2
tab2 %>%
gt::gt(groupname_col = "Model", rowname_col = "term") %>%
gt::tab_header(
title = "Table 2: Best 3 models (topics and terms)"
)
here::here("results", "wordc.rds")
install.packages("wordcloud")
# SAVE THIS AND USE IT LATER LOOKS GREAT
wordcloud::wordcloud(words)
words
# SAVE THIS AND USE IT LATER LOOKS GREAT
wordcloud::wordcloud(words$word)
wordc <- wordcloud2::wordcloud2(words)
wordc
plot1 <- read_rds(here::here("results", "plot_weights.rds"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic")
plot1
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic")+
scale_fill_identity(name = c("relatedness", "innovation", "technical", "complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic")
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic") +
scale_color_manual(labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic") +
scale_color_manual(labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic") +
scale_fill_manual(labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_manual(labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_manual(values = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_manual(labels = c(1, 2, 3, 4), values = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_color_manual(labels = c(1, 2, 3, 4), values = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_discrete(limits = c(1, 2, 3, 4), values = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_discrete(limits = c(1, 2, 3, 4), labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic", fill = "Topic") +
scale_fill_discrete(limits = c(1, 2, 3, 4), labels = c("Relatedness", "Innovation", "Technical", "Complexity"))
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic") +
guides(
fill = guide_legend(
title = "Topic",
override.aes = list(fill = c("Relatedness", "Innovation", "Technical", "Complexity"))
)
)
plot1+
labs(title = "Figure 2: Posterior weights of each words in each topic")
data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta)
data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>% View()
data_for_plot %>%
filter(Model == "alpha_2_iter_1000") %>%
group_by(topic) %>%
slice_max(beta, n = 7) %>%
ungroup() %>%
arrange(topic, -beta) %>% as.data.frame()
lda_results[["alpha_2_iter_1000"]]
lda_results[["alpha_2_iter_1000"]] %>%  inspect()
lda_results[["alpha_2_iter_1000"]]
?LDA
